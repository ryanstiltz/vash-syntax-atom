/*! chevrotain - v0.8.1 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("chevrotain",[],e):"object"==typeof exports?exports.chevrotain=e():t.chevrotain=e()}(this,function(){return function(t){function __webpack_require__(n){if(e[n])return e[n].exports;var r=e[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}var e={};return __webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.p="",__webpack_require__(0)}([function(t,e,n){"use strict";var r=n(1),i=n(11),o=n(10),a=n(5),s=n(7),c=n(21),u={};u.VERSION="0.8.1",u.Parser=r.Parser,u.ParserDefinitionErrorType=r.ParserDefinitionErrorType,u.Lexer=i.Lexer,u.LexerDefinitionErrorType=i.LexerDefinitionErrorType,u.Token=o.Token,u.VirtualToken=o.VirtualToken,u.EOF=o.EOF,u.extendToken=o.extendToken,u.tokenName=o.tokenName,u.tokenLabel=o.tokenLabel,u.EMPTY_ALT=r.EMPTY_ALT,u.exceptions={},u.exceptions.isRecognitionException=a.exceptions.isRecognitionException,u.exceptions.EarlyExitException=a.exceptions.EarlyExitException,u.exceptions.MismatchedTokenException=a.exceptions.MismatchedTokenException,u.exceptions.NotAllInputParsedException=a.exceptions.NotAllInputParsedException,u.exceptions.NoViableAltException=a.exceptions.NoViableAltException,u.gast={},u.gast.GAstVisitor=s.gast.GAstVisitor,u.gast.Flat=s.gast.Flat,u.gast.Repetition=s.gast.Repetition,u.gast.RepetitionWithSeparator=s.gast.RepetitionWithSeparator,u.gast.RepetitionMandatory=s.gast.RepetitionMandatory,u.gast.RepetitionMandatoryWithSeparator=s.gast.RepetitionMandatoryWithSeparator,u.gast.Option=s.gast.Option,u.gast.Alternation=s.gast.Alternation,u.gast.NonTerminal=s.gast.NonTerminal,u.gast.Terminal=s.gast.Terminal,u.gast.Rule=s.gast.Rule,u.clearCache=c.clearCache,t.exports=u},function(t,e,n){"use strict";function EMPTY_ALT(t){return void 0===t&&(t=void 0),function(){return t}}function InRuleRecoveryException(t){this.name=o.functionName(InRuleRecoveryException),this.message=t}var r=n(2),i=n(5),o=n(3),a=n(6),s=n(8),c=n(4),u=n(14),l=n(10),p=n(17),f=n(19),h=n(18),d=n(16),E=n(9);!function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT"}(e.ParserDefinitionErrorType||(e.ParserDefinitionErrorType={}));var T=(e.ParserDefinitionErrorType,Object.freeze({recoveryEnabled:!1})),A=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});e.EMPTY_ALT=EMPTY_ALT;var y={},O=function(){function Parser(t,e,n){if(void 0===n&&(n=T),this.errors=[],this._input=[],this.inputIdx=-1,this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.tokensMap=void 0,this.definedRulesNames=[],this._productions=new o.HashTable,this._input=t,this.recoveryEnabled=c.has(n,"recoveryEnabled")?n.recoveryEnabled:T.recoveryEnabled,this.className=o.classNameFromInstance(this),this.firstAfterRepMap=r.getFirstAfterRepForClass(this.className),this.classLAFuncs=r.getLookaheadFuncsForClass(this.className),r.CLASS_TO_DEFINITION_ERRORS.containsKey(this.className)?this.definitionErrors=r.CLASS_TO_DEFINITION_ERRORS.get(this.className):(this.definitionErrors=[],r.CLASS_TO_DEFINITION_ERRORS.put(this.className,this.definitionErrors)),c.isArray(e))this.tokensMap=c.reduce(e,function(t,e){return t[l.tokenName(e)]=e,t},{});else{if(!c.isObject(e))throw new Error("'tokensMapOrArr' argument must be An Array of Token constructors or a Dictionary of Tokens.");this.tokensMap=c.cloneObj(e)}this.tokensMap[l.tokenName(l.EOF)]=l.EOF,void 0===r.CLASS_TO_OR_LA_CACHE[this.className]&&r.initLookAheadKeyCache(this.className),this.orLookaheadKeys=r.CLASS_TO_OR_LA_CACHE[this.className],this.manyLookaheadKeys=r.CLASS_TO_MANY_LA_CACHE[this.className],this.manySepLookaheadKeys=r.CLASS_TO_MANY_SEP_LA_CACHE[this.className],this.atLeastOneLookaheadKeys=r.CLASS_TO_AT_LEAST_ONE_LA_CACHE[this.className],this.atLeastOneSepLookaheadKeys=r.CLASS_TO_AT_LEAST_ONE_SEP_LA_CACHE[this.className],this.optionLookaheadKeys=r.CLASS_TO_OPTION_LA_CACHE[this.className]}return Parser.performSelfAnalysis=function(t){var e,n=[],i=o.classNameFromInstance(t);if(""===i)throw Error("A Parser's constructor may not be an anonymous Function, it must be a named function\nThe constructor's name is used at runtime for performance (caching) purposes.");if(!r.CLASS_TO_SELF_ANALYSIS_DONE.containsKey(i)){var l=t._productions,p=new o.HashTable;c.forEach(l.keys(),function(t){var e=l.get(t);p.put(t,E.cloneProduction(e))}),r.getProductionsForClass(i).putAll(p),n=r.CLASS_TO_DEFINITION_ERRORS.get(i);var f=a.resolveGrammar(p);n.push.apply(n,f),r.CLASS_TO_SELF_ANALYSIS_DONE.put(i,!0);var h=s.validateGrammar(p.values());if(n.push.apply(n,h),!c.isEmpty(n)&&!Parser.DEFER_DEFINITION_ERRORS_HANDLING)throw e=c.map(n,function(t){return t.message}),new Error("Parser Definition Errors detected\n: "+e.join("\n-------------------------------\n"));if(c.isEmpty(n)){var d=u.computeAllProdsFollows(p.values());r.setResyncFollowsForClass(i,d)}}if(!c.isEmpty(r.CLASS_TO_DEFINITION_ERRORS.get(i))&&!Parser.DEFER_DEFINITION_ERRORS_HANDLING)throw e=c.map(r.CLASS_TO_DEFINITION_ERRORS.get(i),function(t){return t.message}),new Error("Parser Definition Errors detected\n: "+e.join("\n-------------------------------\n"))},Object.defineProperty(Parser.prototype,"input",{get:function(){return c.cloneArr(this._input)},set:function(t){this.reset(),this._input=t},enumerable:!0,configurable:!0}),Parser.prototype.reset=function(){this.isBackTrackingStack=[],this.errors=[],this._input=[],this.inputIdx=-1,this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[]},Parser.prototype.isAtEndOfInput=function(){return this.LA(1)instanceof l.EOF},Parser.prototype.getGAstProductions=function(){return r.getProductionsForClass(this.className)},Parser.prototype.isBackTracking=function(){return!c.isEmpty(this.isBackTrackingStack)},Parser.prototype.SAVE_ERROR=function(t){if(i.exceptions.isRecognitionException(t))return t.context={ruleStack:c.cloneArr(this.RULE_STACK),ruleOccurrenceStack:c.cloneArr(this.RULE_OCCURRENCE_STACK)},this.errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")},Parser.prototype.NEXT_TOKEN=function(){return this.LA(1)},Parser.prototype.LA=function(t){return this._input.length<=this.inputIdx+t?new l.EOF:this._input[this.inputIdx+t]},Parser.prototype.isNextRule=function(t){var e=r.getLookaheadFuncsForClass(this.className),n=e.get(t);if(void 0===n){var i=this.getGAstProductions().get(t);n=p.buildLookaheadForTopLevel(i),e.put(t,n)}return n.call(this)},Parser.prototype.BACKTRACK=function(t,e){var n=this;return function(){n.isBackTrackingStack.push(1);var r=n.saveRecogState();try{var o=t.call(n);return e(o)}catch(a){if(i.exceptions.isRecognitionException(a))return!1;throw a}finally{n.reloadRecogState(r),n.isBackTrackingStack.pop()}}},Parser.prototype.SKIP_TOKEN=function(){return this.inputIdx<=this._input.length-2?(this.inputIdx++,this.NEXT_TOKEN()):new l.EOF},Parser.prototype.CONSUME=function(t){return this.CONSUME1(t)},Parser.prototype.CONSUME1=function(t){return this.consumeInternal(t,1)},Parser.prototype.CONSUME2=function(t){return this.consumeInternal(t,2)},Parser.prototype.CONSUME3=function(t){return this.consumeInternal(t,3)},Parser.prototype.CONSUME4=function(t){return this.consumeInternal(t,4)},Parser.prototype.CONSUME5=function(t){return this.consumeInternal(t,5)},Parser.prototype.SUBRULE=function(t,e){return void 0===e&&(e=[]),this.SUBRULE1(t,e)},Parser.prototype.SUBRULE1=function(t,e){return void 0===e&&(e=[]),t.call(this,1,e)},Parser.prototype.SUBRULE2=function(t,e){return void 0===e&&(e=[]),t.call(this,2,e)},Parser.prototype.SUBRULE3=function(t,e){return void 0===e&&(e=[]),t.call(this,3,e)},Parser.prototype.SUBRULE4=function(t,e){return void 0===e&&(e=[]),t.call(this,4,e)},Parser.prototype.SUBRULE5=function(t,e){return void 0===e&&(e=[]),t.call(this,5,e)},Parser.prototype.OPTION=function(t,e){return this.OPTION1.call(this,t,e)},Parser.prototype.OPTION1=function(t,e){return void 0===e&&(e=t,t=this.getLookaheadFuncForOption(1)),this.optionInternal(t,e)},Parser.prototype.OPTION2=function(t,e){return void 0===e&&(e=t,t=this.getLookaheadFuncForOption(2)),this.optionInternal(t,e)},Parser.prototype.OPTION3=function(t,e){return void 0===e&&(e=t,t=this.getLookaheadFuncForOption(3)),this.optionInternal(t,e)},Parser.prototype.OPTION4=function(t,e){return void 0===e&&(e=t,t=this.getLookaheadFuncForOption(4)),this.optionInternal(t,e)},Parser.prototype.OPTION5=function(t,e){return void 0===e&&(e=t,t=this.getLookaheadFuncForOption(5)),this.optionInternal(t,e)},Parser.prototype.OR=function(t,e,n){return void 0===n&&(n=!1),this.OR1(t,e,n)},Parser.prototype.OR1=function(t,e,n){return void 0===n&&(n=!1),this.orInternal(t,e,1,n)},Parser.prototype.OR2=function(t,e,n){return void 0===n&&(n=!1),this.orInternal(t,e,2,n)},Parser.prototype.OR3=function(t,e,n){return void 0===n&&(n=!1),this.orInternal(t,e,3,n)},Parser.prototype.OR4=function(t,e,n){return void 0===n&&(n=!1),this.orInternal(t,e,4,n)},Parser.prototype.OR5=function(t,e,n){return void 0===n&&(n=!1),this.orInternal(t,e,5,n)},Parser.prototype.MANY=function(t,e){return this.MANY1.call(this,t,e)},Parser.prototype.MANY1=function(t,e){this.manyInternal(this.MANY1,"MANY1",1,t,e)},Parser.prototype.MANY2=function(t,e){this.manyInternal(this.MANY2,"MANY2",2,t,e)},Parser.prototype.MANY3=function(t,e){this.manyInternal(this.MANY3,"MANY3",3,t,e)},Parser.prototype.MANY4=function(t,e){this.manyInternal(this.MANY4,"MANY4",4,t,e)},Parser.prototype.MANY5=function(t,e){this.manyInternal(this.MANY5,"MANY5",5,t,e)},Parser.prototype.MANY_SEP=function(t,e,n){return this.MANY_SEP1.call(this,t,e,n)},Parser.prototype.MANY_SEP1=function(t,e,n){return this.manySepFirstInternal(this.MANY_SEP1,"MANY_SEP1",1,t,e,n)},Parser.prototype.MANY_SEP2=function(t,e,n){return this.manySepFirstInternal(this.MANY_SEP2,"MANY_SEP2",2,t,e,n)},Parser.prototype.MANY_SEP3=function(t,e,n){return this.manySepFirstInternal(this.MANY_SEP3,"MANY_SEP3",3,t,e,n)},Parser.prototype.MANY_SEP4=function(t,e,n){return this.manySepFirstInternal(this.MANY_SEP4,"MANY_SEP4",4,t,e,n)},Parser.prototype.MANY_SEP5=function(t,e,n){return this.manySepFirstInternal(this.MANY_SEP5,"MANY_SEP5",5,t,e,n)},Parser.prototype.AT_LEAST_ONE=function(t,e,n){return this.AT_LEAST_ONE1.call(this,t,e,n)},Parser.prototype.AT_LEAST_ONE1=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE1,"AT_LEAST_ONE1",1,t,e,n)},Parser.prototype.AT_LEAST_ONE2=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE2,"AT_LEAST_ONE2",2,t,e,n)},Parser.prototype.AT_LEAST_ONE3=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE3,"AT_LEAST_ONE3",3,t,e,n)},Parser.prototype.AT_LEAST_ONE4=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE4,"AT_LEAST_ONE4",4,t,e,n)},Parser.prototype.AT_LEAST_ONE5=function(t,e,n){this.atLeastOneInternal(this.AT_LEAST_ONE5,"AT_LEAST_ONE5",5,t,e,n)},Parser.prototype.AT_LEAST_ONE_SEP=function(t,e,n,r){return this.AT_LEAST_ONE_SEP1.call(this,t,e,n,r)},Parser.prototype.AT_LEAST_ONE_SEP1=function(t,e,n,r){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP1",1,t,e,n,r)},Parser.prototype.AT_LEAST_ONE_SEP2=function(t,e,n,r){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP2",2,t,e,n,r)},Parser.prototype.AT_LEAST_ONE_SEP3=function(t,e,n,r){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP3",3,t,e,n,r)},Parser.prototype.AT_LEAST_ONE_SEP4=function(t,e,n,r){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP4",4,t,e,n,r)},Parser.prototype.AT_LEAST_ONE_SEP5=function(t,e,n,r){return this.atLeastOneSepFirstInternal(this.atLeastOneSepFirstInternal,"AT_LEAST_ONE_SEP5",5,t,e,n,r)},Parser.prototype.RULE=function(t,e,n){void 0===n&&(n=A);var i=s.validateRuleName(t,this.className);if(i=i.concat(s.validateRuleDoesNotAlreadyExist(t,this.definedRulesNames,this.className)),this.definedRulesNames.push(t),this.definitionErrors.push.apply(this.definitionErrors,i),this._productions.containsKey(t)){var o=r.getProductionsForClass(this.className),a=o.get(t);c.isUndefined(a)||this._productions.put(t,a)}else{var u=f.buildTopProduction(e.toString(),t,this.tokensMap);this._productions.put(t,u)}return this.defineRule(t,e,n)},Parser.prototype.OVERRIDE_RULE=function(t,e,n){void 0===n&&(n=A);var i=s.validateRuleName(t,this.className);i=i.concat(s.validateRuleIsOverridden(t,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,i);var o=r.getProductionOverriddenForClass(this.className);if(o.containsKey(t)){var a=r.getProductionsForClass(this.className);this._productions.put(t,a.get(t))}else{o.put(t,!0);var c=f.buildTopProduction(e.toString(),t,this.tokensMap);this._productions.put(t,c)}return this.defineRule(t,e,n)},Parser.prototype.ruleInvocationStateUpdate=function(t,e){this.RULE_OCCURRENCE_STACK.push(e),this.RULE_STACK.push(t)},Parser.prototype.ruleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop();var t=this._input.length-1;if(0===this.RULE_STACK.length&&this.inputIdx<t){var e=this.NEXT_TOKEN();this.SAVE_ERROR(new i.exceptions.NotAllInputParsedException("Redundant input, expecting EOF but found: "+e.image,e))}},Parser.prototype.getTokenToInsert=function(t){return new t(-1,-1)},Parser.prototype.canTokenTypeBeInsertedInRecovery=function(t){return!0},Parser.prototype.getMisMatchTokenErrorMessage=function(t,e){var n=l.hasTokenLabel(t),r=n?"--> "+l.tokenLabel(t)+" <--":"token of type --> "+l.tokenName(t)+" <--",i="Expecting "+r+" but found --> '"+e.image+"' <--";return i},Parser.prototype.defineRule=function(t,e,n){var r=c.has(n,"resyncEnabled")?n.resyncEnabled:A.resyncEnabled,o=c.has(n,"recoveryValueFunc")?n.recoveryValueFunc:A.recoveryValueFunc,a=function(n,a){void 0===n&&(n=1),void 0===a&&(a=[]),this.ruleInvocationStateUpdate(t,n);try{return e.apply(this,a)}catch(s){var c=1===this.RULE_STACK.length,u=c||r&&!this.isBackTracking()&&this.recoveryEnabled;if(u&&i.exceptions.isRecognitionException(s)){var l=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(l))return s.resyncedTokens=this.reSyncTo(l),o();throw s}throw s}finally{this.ruleFinallyStateUpdate()}},s="ruleName";return a[s]=t,a},Parser.prototype.tryInRepetitionRecovery=function(t,e,n,r){for(var o=this,a=this.findReSyncTokenType(),s=this.inputIdx,u=[],l=!1,p=this.NEXT_TOKEN(),f=this.NEXT_TOKEN(),h=function(){var t=o.getMisMatchTokenErrorMessage(r,p),e=new i.exceptions.MismatchedTokenException(t,p);e.resyncedTokens=c.dropRight(u),o.SAVE_ERROR(e)};!l;){if(f instanceof r)return void h();if(n.call(this))return h(),void t.apply(this,e);f instanceof a?l=!0:(f=this.SKIP_TOKEN(),this.addToResyncTokens(f,u))}this.inputIdx=s},Parser.prototype.shouldInRepetitionRecoveryBeTried=function(t,e){return void 0===t||void 0===e?!1:this.NEXT_TOKEN()instanceof t?!1:this.isBackTracking()?!1:!this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,e))},Parser.prototype.getFollowsForInRuleRecovery=function(t,e){var n=c.cloneArr(this.RULE_STACK),r=c.cloneArr(this.RULE_OCCURRENCE_STACK),i={ruleStack:n,occurrenceStack:r,lastTok:t,lastTokOccurrence:e},o=c.first(n),a=this.getGAstProductions(),s=a.get(o),u=new h.NextAfterTokenWalker(s,i).startWalking();return u},Parser.prototype.tryInRuleRecovery=function(t,e){if(this.canRecoverWithSingleTokenInsertion(t,e)){var n=this.getTokenToInsert(t);return n.isInsertedInRecovery=!0,n}if(this.canRecoverWithSingleTokenDeletion(t)){var r=this.SKIP_TOKEN();return this.inputIdx++,r}throw new InRuleRecoveryException("sad sad panda")},Parser.prototype.canPerformInRuleRecovery=function(t,e){return this.canRecoverWithSingleTokenInsertion(t,e)||this.canRecoverWithSingleTokenDeletion(t)},Parser.prototype.canRecoverWithSingleTokenInsertion=function(t,e){if(!this.canTokenTypeBeInsertedInRecovery(t))return!1;if(c.isEmpty(e))return!1;var n=this.NEXT_TOKEN(),r=void 0!==c.find(e,function(t){return n instanceof t});return r},Parser.prototype.canRecoverWithSingleTokenDeletion=function(t){var e=this.LA(2)instanceof t;return e},Parser.prototype.isInCurrentRuleReSyncSet=function(t){var e=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(e);return c.contains(n,t)},Parser.prototype.findReSyncTokenType=function(){for(var t=this.flattenFollowSet(),e=this.NEXT_TOKEN(),n=2;;){var r=e.constructor;if(c.contains(t,r))return r;e=this.LA(n),n++}},Parser.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return y;var t=this.RULE_STACK.length-1,e=t,n=t-1;return{ruleName:this.RULE_STACK[t],idxInCallingRule:this.RULE_OCCURRENCE_STACK[e],inRule:this.RULE_STACK[n]}},Parser.prototype.buildFullFollowKeyStack=function(){var t=this;return c.map(this.RULE_STACK,function(e,n){return 0===n?y:{ruleName:e,idxInCallingRule:t.RULE_OCCURRENCE_STACK[n],inRule:t.RULE_STACK[n-1]}})},Parser.prototype.flattenFollowSet=function(){var t=this,e=c.map(this.buildFullFollowKeyStack(),function(e){return t.getFollowSetFromFollowKey(e)});return c.flatten(e)},Parser.prototype.getFollowSetFromFollowKey=function(t){if(t===y)return[l.EOF];var e=t.ruleName+t.idxInCallingRule+d.IN+t.inRule;return r.getResyncFollowsForClass(this.className).get(e)},Parser.prototype.addToResyncTokens=function(t,e){return t instanceof l.EOF||e.push(t),e},Parser.prototype.reSyncTo=function(t){for(var e=[],n=this.NEXT_TOKEN();n instanceof t==!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,e);return c.dropRight(e)},Parser.prototype.attemptInRepetitionRecovery=function(t,e,n,r,i,o,a){var s=this.getKeyForAutomaticLookahead(r,a,i),u=this.firstAfterRepMap.get(s);if(void 0===u){var p=c.last(this.RULE_STACK),f=this.getGAstProductions().get(p),h=new o(f,i);u=h.startWalking(),this.firstAfterRepMap.put(s,u)}var d=u.token,E=u.occurrence,T=u.isEndOfRule;1===this.RULE_STACK.length&&T&&void 0===d&&(d=l.EOF,E=1),this.shouldInRepetitionRecoveryBeTried(d,E)&&this.tryInRepetitionRecovery(t,e,n,d)},Parser.prototype.optionInternal=function(t,e){return t.call(this)?(e.call(this),!0):!1},Parser.prototype.atLeastOneInternal=function(t,e,n,r,i,o){if(c.isFunction(i)||(o=i,i=r,r=this.getLookaheadFuncForAtLeastOne(n)),!r.call(this))throw this.raiseEarlyExitException(n,h.NextInsideAtLeastOneWalker,o);for(i.call(this);r.call(this);)i.call(this);this.recoveryEnabled&&this.attemptInRepetitionRecovery(t,[r,i,o],r,e,n,h.NextTerminalAfterAtLeastOneWalker,this.atLeastOneLookaheadKeys)},Parser.prototype.atLeastOneSepFirstInternal=function(t,e,n,r,i,o,a){var s=this,u=[];if(c.isFunction(o)||(a=o,o=i,i=this.getLookaheadFuncForAtLeastOneSep(n)),!i.call(this))throw this.raiseEarlyExitException(n,h.NextInsideAtLeastOneSepWalker,a);o.call(this);for(var l=function(){return s.NEXT_TOKEN()instanceof r};l();)u.push(this.CONSUME(r)),o.call(this);return this.recoveryEnabled&&this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,r,l,o,u,this.atLeastOneSepLookaheadKeys,h.NextTerminalAfterAtLeastOneSepWalker],l,e,n,h.NextTerminalAfterAtLeastOneSepWalker,this.atLeastOneSepLookaheadKeys),u},Parser.prototype.manyInternal=function(t,e,n,r,i){for(void 0===i&&(i=r,r=this.getLookaheadFuncForMany(n));r.call(this);)i.call(this);this.recoveryEnabled&&this.attemptInRepetitionRecovery(t,[r,i],r,e,n,h.NextTerminalAfterManyWalker,this.manyLookaheadKeys)},Parser.prototype.manySepFirstInternal=function(t,e,n,r,i,o){var a=this,s=[];if(void 0===o&&(o=i,i=this.getLookaheadFuncForManySep(n)),i.call(this)){o.call(this);for(var c=function(){return a.NEXT_TOKEN()instanceof r};c();)s.push(this.CONSUME(r)),o.call(this);this.recoveryEnabled&&this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,r,c,o,s,this.manySepLookaheadKeys,h.NextTerminalAfterManySepWalker],c,e,n,h.NextTerminalAfterManySepWalker,this.manySepLookaheadKeys)}return s},Parser.prototype.repetitionSepSecondInternal=function(t,e,n,r,i,o,a,s){for(;r();)o.push(this.CONSUME(n)),i.call(this);this.recoveryEnabled&&this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,e,n,r,i,o,a,s],r,t,e,s,a)},Parser.prototype.orInternal=function(t,e,n,r){if(void 0!==t[0].WHEN){for(var i=0;i<t.length;i++)if(t[i].WHEN.call(this)){var o=t[i].THEN_DO();return o}this.raiseNoAltException(n,e)}var a=this.getLookaheadFuncForOr(n,r),s=a.call(this);return-1!==s?t[s].ALT.call(this):void this.raiseNoAltException(n,e)},Parser.prototype.consumeInternal=function(t,e){try{return this.consumeInternalOptimized(t)}catch(n){if(!(this.recoveryEnabled&&n instanceof i.exceptions.MismatchedTokenException)||this.isBackTracking())throw n;var r=this.getFollowsForInRuleRecovery(t,e);try{return this.tryInRuleRecovery(t,r)}catch(a){throw a.name===o.functionName(InRuleRecoveryException)?n:a}}},Parser.prototype.consumeInternalOptimized=function(t){var e=this.NEXT_TOKEN();if(this.NEXT_TOKEN()instanceof t)return this.inputIdx++,e;var n=this.getMisMatchTokenErrorMessage(t,e);throw this.SAVE_ERROR(new i.exceptions.MismatchedTokenException(n,e))},Parser.prototype.getKeyForAutomaticLookahead=function(t,e,n){var r=e[n-1],i=c.last(this.RULE_STACK),o=r[i];return void 0===o&&(o=t+n+d.IN+i,r[i]=o),o},Parser.prototype.getLookaheadFuncForOption=function(t){var e=this.getKeyForAutomaticLookahead("OPTION",this.optionLookaheadKeys,t);return this.getLookaheadFuncFor(e,t,p.buildLookaheadForOption)},Parser.prototype.getLookaheadFuncForOr=function(t,e){var n=this.getKeyForAutomaticLookahead("OR",this.orLookaheadKeys,t);return this.getLookaheadFuncFor(n,t,p.buildLookaheadForOr,[e])},Parser.prototype.getLookaheadFuncForMany=function(t){var e=this.getKeyForAutomaticLookahead("MANY",this.manyLookaheadKeys,t);return this.getLookaheadFuncFor(e,t,p.buildLookaheadForMany)},Parser.prototype.getLookaheadFuncForManySep=function(t){var e=this.getKeyForAutomaticLookahead("MANY_SEP",this.manySepLookaheadKeys,t);return this.getLookaheadFuncFor(e,t,p.buildLookaheadForManySep)},Parser.prototype.getLookaheadFuncForAtLeastOne=function(t){var e=this.getKeyForAutomaticLookahead("AT_LEAST_ONE",this.atLeastOneLookaheadKeys,t);return this.getLookaheadFuncFor(e,t,p.buildLookaheadForAtLeastOne)},Parser.prototype.getLookaheadFuncForAtLeastOneSep=function(t){var e=this.getKeyForAutomaticLookahead("AT_LEAST_ONE_SEP",this.atLeastOneSepLookaheadKeys,t);return this.getLookaheadFuncFor(e,t,p.buildLookaheadForAtLeastOneSep)},Parser.prototype.getLookaheadFuncFor=function(t,e,n,r){void 0===r&&(r=[]);var i=c.last(this.RULE_STACK),o=this.classLAFuncs.get(t);if(void 0===o){var a=this.getGAstProductions().get(i);o=n.apply(null,[e,a].concat(r)),this.classLAFuncs.put(t,o)}return o},Parser.prototype.saveRecogState=function(){var t=c.cloneArr(this.errors),e=c.cloneArr(this.RULE_STACK);return{errors:t,inputIdx:this.inputIdx,RULE_STACK:e}},Parser.prototype.reloadRecogState=function(t){this.errors=t.errors,this.inputIdx=t.inputIdx,this.RULE_STACK=t.RULE_STACK},Parser.prototype.raiseNoAltException=function(t,e){var n=" but found: '"+this.NEXT_TOKEN().image+"'";if(void 0===e){var r=c.last(this.RULE_STACK),o=this.getGAstProductions().get(r),a=new h.NextInsideOrWalker(o,t).startWalking(),s=c.flatten(a),u=c.map(s,function(t){return l.tokenLabel(t)});e="one of: <"+u.join(" ,")+">"}throw this.SAVE_ERROR(new i.exceptions.NoViableAltException("Expecting: "+e+" "+n,this.NEXT_TOKEN()))},Parser.prototype.raiseEarlyExitException=function(t,e,n){var r=" but found: '"+this.NEXT_TOKEN().image+"'";if(void 0===n){var o=c.last(this.RULE_STACK),a=this.getGAstProductions().get(o),s={ruleStack:this.RULE_STACK,occurrenceStack:this.RULE_OCCURRENCE_STACK,occurrence:t},u=new e(a,s).startWalking(),p=c.flatten(u),f=c.map(p,function(t){return l.tokenLabel(t)});n="expecting at least one iteration which starts with one of: <"+f.join(" ,")+">"}else n="Expecting at least one "+n;throw this.SAVE_ERROR(new i.exceptions.EarlyExitException(n+r,this.NEXT_TOKEN()))},Parser.IGNORE_AMBIGUITIES=!0,Parser.NO_RESYNC=!1,Parser.DEFER_DEFINITION_ERRORS_HANDLING=!1,Parser}();e.Parser=O,InRuleRecoveryException.prototype=Error.prototype},function(t,e,n){"use strict";function getProductionsForClass(t){return getFromNestedHashTable(t,e.CLASS_TO_GRAMMAR_PRODUCTIONS)}function getResyncFollowsForClass(t){return getFromNestedHashTable(t,e.CLASS_TO_RESYNC_FOLLOW_SETS)}function setResyncFollowsForClass(t,n){e.CLASS_TO_RESYNC_FOLLOW_SETS.put(t,n)}function getLookaheadFuncsForClass(t){return getFromNestedHashTable(t,e.CLASS_TO_LOOKAHEAD_FUNCS)}function getFirstAfterRepForClass(t){return getFromNestedHashTable(t,e.CLASS_TO_FIRST_AFTER_REPETITION)}function getProductionOverriddenForClass(t){return getFromNestedHashTable(t,e.CLASS_TO_PRODUCTION_OVERRIDEN)}function initLookAheadKeyCache(t){e.CLASS_TO_OR_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_MANY_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_MANY_SEP_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_AT_LEAST_ONE_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_AT_LEAST_ONE_SEP_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),e.CLASS_TO_OPTION_LA_CACHE[t]=new Array(e.MAX_OCCURRENCE_INDEX),initSingleLookAheadKeyCache(e.CLASS_TO_OR_LA_CACHE[t]),initSingleLookAheadKeyCache(e.CLASS_TO_MANY_LA_CACHE[t]),initSingleLookAheadKeyCache(e.CLASS_TO_MANY_SEP_LA_CACHE[t]),initSingleLookAheadKeyCache(e.CLASS_TO_AT_LEAST_ONE_LA_CACHE[t]),initSingleLookAheadKeyCache(e.CLASS_TO_AT_LEAST_ONE_SEP_LA_CACHE[t]),initSingleLookAheadKeyCache(e.CLASS_TO_OPTION_LA_CACHE[t])}function initSingleLookAheadKeyCache(t){for(var n=0;n<e.MAX_OCCURRENCE_INDEX;n++)t[n]=new r.HashTable}function getFromNestedHashTable(t,e){var n=e.get(t);return void 0===n&&(e.put(t,new r.HashTable),n=e.get(t)),n}function clearCache(){var e=i.filter(i.values(t.exports),function(t){return t instanceof r.HashTable});i.forEach(e,function(t){return t.clear()})}var r=n(3),i=n(4);e.CLASS_TO_DEFINITION_ERRORS=new r.HashTable,e.CLASS_TO_SELF_ANALYSIS_DONE=new r.HashTable,e.CLASS_TO_GRAMMAR_PRODUCTIONS=new r.HashTable,e.getProductionsForClass=getProductionsForClass,e.CLASS_TO_RESYNC_FOLLOW_SETS=new r.HashTable,e.getResyncFollowsForClass=getResyncFollowsForClass,e.setResyncFollowsForClass=setResyncFollowsForClass,e.CLASS_TO_LOOKAHEAD_FUNCS=new r.HashTable,e.getLookaheadFuncsForClass=getLookaheadFuncsForClass,e.CLASS_TO_FIRST_AFTER_REPETITION=new r.HashTable,e.getFirstAfterRepForClass=getFirstAfterRepForClass,e.CLASS_TO_PRODUCTION_OVERRIDEN=new r.HashTable,e.getProductionOverriddenForClass=getProductionOverriddenForClass,e.CLASS_TO_OR_LA_CACHE=new r.HashTable,e.CLASS_TO_MANY_LA_CACHE=new r.HashTable,e.CLASS_TO_MANY_SEP_LA_CACHE=new r.HashTable,e.CLASS_TO_AT_LEAST_ONE_LA_CACHE=new r.HashTable,e.CLASS_TO_AT_LEAST_ONE_SEP_LA_CACHE=new r.HashTable,e.CLASS_TO_OPTION_LA_CACHE=new r.HashTable,e.MAX_OCCURRENCE_INDEX=5,e.initLookAheadKeyCache=initLookAheadKeyCache,e.clearCache=clearCache},function(t,e,n){"use strict";function classNameFromInstance(t){return functionName(t.constructor)}function functionName(t){if(o)return t.name;if(t.rdtFuncNameCache666)return t.rdtFuncNameCache666;var e=t.toString().match(i)[1];return t.rdtFuncNameCache666=e,e}var r=n(4),i=/^\s*function\s*(\S*)\s*\(/,o="undefined"!=typeof function(){}.name;e.classNameFromInstance=classNameFromInstance,e.functionName=functionName;var a=function(){function HashTable(){this._state={}}return HashTable.prototype.keys=function(){return r.keys(this._state)},HashTable.prototype.values=function(){return r.values(this._state)},HashTable.prototype.put=function(t,e){this._state[t]=e},HashTable.prototype.putAll=function(t){this._state=r.assign(this._state,t._state)},HashTable.prototype.get=function(t){return this._state[t]},HashTable.prototype.containsKey=function(t){return r.has(this._state,t)},HashTable.prototype.clear=function(){this._state={}},HashTable}();e.HashTable=a},function(t,e){"use strict";function isEmpty(t){return t&&0===t.length}function keys(t){return Object.keys(t)}function values(t){for(var e=[],n=Object.keys(t),r=0;r<n.length;r++)e.push(t[n[r]]);return e}function map(t,e){for(var n=[],r=0;r<t.length;r++)n.push(e.call(null,t[r],r));return n}function flatten(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];Array.isArray(r)?e=e.concat(flatten(r)):e.push(r)}return e}function first(t){return isEmpty(t)?void 0:t[0]}function last(t){var e=t&&t.length;return e?t[e-1]:void 0}function forEach(t,e){if(Array.isArray(t))for(var n=0;n<t.length;n++)e.call(null,t[n],n);else{if(!isObject(t))throw Error("non exhaustive match");for(var r=keys(t),n=0;n<r.length;n++){var i=r[n],o=t[i];e.call(null,o,i)}}}function isString(t){return"string"==typeof t}function isUndefined(t){return void 0===t}function isFunction(t){return t instanceof Function}function drop(t,e){return void 0===e&&(e=1),t.slice(e,t.length)}function dropRight(t,e){return void 0===e&&(e=1),t.slice(0,t.length-e)}function filter(t,e){var n=[];if(Array.isArray(t))for(var r=0;r<t.length;r++){var i=t[r];e.call(null,i)&&n.push(i)}return n}function reject(t,e){return filter(t,function(t){return!e(t)})}function pick(t,e){for(var n=Object.keys(t),r={},i=0;i<n.length;i++){var o=n[i],a=t[o];e(a)&&(r[o]=a)}return r}function has(t,e){return t.hasOwnProperty(e)}function contains(t,e){return void 0!==find(t,function(t){return t===e})}function cloneArr(t){return map(t,function(t){return t})}function cloneObj(t){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function find(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(e.call(null,r))return r}}function reduce(t,e,n){for(var r=Array.isArray(t)?t:values(t),i=n,o=0;o<r.length;o++)i=e.call(null,i,r[o]);return i}function compact(t){return reject(t,function(t){return null===t||void 0===t})}function uniq(t,e){void 0===e&&(e=function(t){return t});var n=[];return reduce(t,function(t,r){var i=e(r);return contains(n,i)?t:(n.push(i),t.concat(r))},[])}function partial(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=[null],i=r.concat(e);return Function.bind.apply(t,i)}function isArray(t){return Array.isArray(t)}function isRegExp(t){return t instanceof RegExp}function isObject(t){return t instanceof Object}function every(t,e){for(var n=0;n<t.length;n++)if(!e(t[n]))return!1;return!0}function difference(t,e){return reject(t,function(t){return contains(e,t)})}function some(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function indexOf(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}function sortBy(t,e){var n=cloneArr(t);return n.sort(function(t,n){return e(t)-e(n)}),n}function zipObject(t,e){if(t.length!==e.length)throw Error("can't zipObject with different number of keys and values!");for(var n={},r=0;r<t.length;r++)n[t[r]]=e[r];return n}function assign(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],o=keys(i),a=0;a<o.length;a++){var s=o[a];t[s]=i[s]}return t}function groupBy(t,e){var n={};return forEach(t,function(t){var r=e(t),i=n[r];i?i.push(t):n[r]=[t]}),n}function merge(t,e){for(var n=cloneObj(t),r=keys(e),i=0;i<r.length;i++){var o=r[i],a=e[o];n[o]=a}return n}e.isEmpty=isEmpty,e.keys=keys,e.values=values,e.map=map,e.flatten=flatten,e.first=first,e.last=last,e.forEach=forEach,e.isString=isString,e.isUndefined=isUndefined,e.isFunction=isFunction,e.drop=drop,e.dropRight=dropRight,e.filter=filter,e.reject=reject,e.pick=pick,e.has=has,e.contains=contains,e.cloneArr=cloneArr,e.cloneObj=cloneObj,e.find=find,e.reduce=reduce,e.compact=compact,e.uniq=uniq,e.partial=partial,e.isArray=isArray,e.isRegExp=isRegExp,e.isObject=isObject,e.every=every,e.difference=difference,e.some=some,e.indexOf=indexOf,e.sortBy=sortBy,e.zipObject=zipObject,e.assign=assign,e.groupBy=groupBy,e.merge=merge},function(t,e,n){"use strict";var r,i=n(3),o=n(4);!function(t){function isRecognitionException(t){
var e=[i.functionName(MismatchedTokenException),i.functionName(NoViableAltException),i.functionName(EarlyExitException),i.functionName(NotAllInputParsedException)];return o.contains(e,t.name)}function MismatchedTokenException(t,e){this.name=i.functionName(MismatchedTokenException),this.message=t,this.token=e,this.resyncedTokens=[]}function NoViableAltException(t,e){this.name=i.functionName(NoViableAltException),this.message=t,this.token=e,this.resyncedTokens=[]}function NotAllInputParsedException(t,e){this.name=i.functionName(NotAllInputParsedException),this.message=t,this.token=e,this.resyncedTokens=[]}function EarlyExitException(t,e){this.name=i.functionName(EarlyExitException),this.message=t,this.token=e,this.resyncedTokens=[]}t.isRecognitionException=isRecognitionException,t.MismatchedTokenException=MismatchedTokenException,MismatchedTokenException.prototype=Error.prototype,t.NoViableAltException=NoViableAltException,NoViableAltException.prototype=Error.prototype,t.NotAllInputParsedException=NotAllInputParsedException,NotAllInputParsedException.prototype=Error.prototype,t.EarlyExitException=EarlyExitException,EarlyExitException.prototype=Error.prototype}(r=e.exceptions||(e.exceptions={}))},function(t,e,n){"use strict";function resolveGrammar(t){var e=new s(t);return e.resolveRefs(),e.errors}var r=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},i=n(1),o=n(7),a=n(4);e.resolveGrammar=resolveGrammar;var s=function(t){function GastRefResolverVisitor(e){t.call(this),this.nameToTopRule=e,this.errors=[]}return r(GastRefResolverVisitor,t),GastRefResolverVisitor.prototype.resolveRefs=function(){var t=this;a.forEach(this.nameToTopRule.values(),function(e){t.currTopLevel=e,e.accept(t)})},GastRefResolverVisitor.prototype.visitNonTerminal=function(t){var e=this.nameToTopRule.get(t.nonTerminalName);if(e)t.referencedRule=e;else{var n="Invalid grammar, reference to rule which is not defined --> "+t.nonTerminalName;this.errors.push({message:n,type:i.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},GastRefResolverVisitor}(o.gast.GAstVisitor);e.GastRefResolverVisitor=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},o=n(4);!function(t){var e=function(){function AbstractProduction(t){this.definition=t,this.implicitOccurrenceIndex=!1}return AbstractProduction.prototype.accept=function(t){t.visit(this),o.forEach(this.definition,function(e){e.accept(t)})},AbstractProduction}();t.AbstractProduction=e;var n=function(t){function NonTerminal(e,n,r){void 0===n&&(n=void 0),void 0===r&&(r=1),t.call(this,[]),this.nonTerminalName=e,this.referencedRule=n,this.occurrenceInParent=r}return i(NonTerminal,t),Object.defineProperty(NonTerminal.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),NonTerminal.prototype.accept=function(t){t.visit(this)},NonTerminal}(e);t.NonTerminal=n;var r=function(t){function Rule(e,n,r){void 0===r&&(r=""),t.call(this,n),this.name=e,this.orgText=r}return i(Rule,t),Rule}(e);t.Rule=r;var a=function(t){function Flat(e){t.call(this,e)}return i(Flat,t),Flat}(e);t.Flat=a;var s=function(t){function Option(e,n){void 0===n&&(n=1),t.call(this,e),this.occurrenceInParent=n}return i(Option,t),Option}(e);t.Option=s;var c=function(t){function RepetitionMandatory(e,n){void 0===n&&(n=1),t.call(this,e),this.occurrenceInParent=n}return i(RepetitionMandatory,t),RepetitionMandatory}(e);t.RepetitionMandatory=c;var u=function(t){function RepetitionMandatoryWithSeparator(e,n,r){void 0===r&&(r=1),t.call(this,e),this.separator=n,this.occurrenceInParent=r}return i(RepetitionMandatoryWithSeparator,t),RepetitionMandatoryWithSeparator}(e);t.RepetitionMandatoryWithSeparator=u;var l=function(t){function Repetition(e,n){void 0===n&&(n=1),t.call(this,e),this.occurrenceInParent=n}return i(Repetition,t),Repetition}(e);t.Repetition=l;var p=function(t){function RepetitionWithSeparator(e,n,r){void 0===r&&(r=1),t.call(this,e),this.separator=n,this.occurrenceInParent=r}return i(RepetitionWithSeparator,t),RepetitionWithSeparator}(e);t.RepetitionWithSeparator=p;var f=function(t){function Alternation(e,n){void 0===n&&(n=1),t.call(this,e),this.occurrenceInParent=n}return i(Alternation,t),Alternation}(e);t.Alternation=f;var h=function(){function Terminal(t,e){void 0===e&&(e=1),this.terminalType=t,this.occurrenceInParent=e,this.implicitOccurrenceIndex=!1}return Terminal.prototype.accept=function(t){t.visit(this)},Terminal}();t.Terminal=h;var d=function(){function GAstVisitor(){}return GAstVisitor.prototype.visit=function(t){if(t instanceof n)return this.visitNonTerminal(t);if(t instanceof a)return this.visitFlat(t);if(t instanceof s)return this.visitOption(t);if(t instanceof c)return this.visitRepetitionMandatory(t);if(t instanceof u)return this.visitRepetitionMandatoryWithSeparator(t);if(t instanceof p)return this.visitRepetitionWithSeparator(t);if(t instanceof l)return this.visitRepetition(t);if(t instanceof f)return this.visitAlternation(t);if(t instanceof h)return this.visitTerminal(t);if(t instanceof r)return this.visitRule(t);throw Error("non exhaustive match")},GAstVisitor.prototype.visitNonTerminal=function(t){},GAstVisitor.prototype.visitFlat=function(t){},GAstVisitor.prototype.visitOption=function(t){},GAstVisitor.prototype.visitRepetition=function(t){},GAstVisitor.prototype.visitRepetitionMandatory=function(t){},GAstVisitor.prototype.visitRepetitionMandatoryWithSeparator=function(t){},GAstVisitor.prototype.visitRepetitionWithSeparator=function(t){},GAstVisitor.prototype.visitAlternation=function(t){},GAstVisitor.prototype.visitTerminal=function(t){},GAstVisitor.prototype.visitRule=function(t){},GAstVisitor}();t.GAstVisitor=d}(r=e.gast||(e.gast={}))},function(t,e,n){"use strict";function validateGrammar(t){var e=i.map(t,validateDuplicateProductions),n=i.map(t,function(t){return validateNoLeftRecursion(t,t)}),r=i.map(t,validateEmptyOrAlternative);return i.flatten(e.concat(n,r))}function validateDuplicateProductions(t){var e=new l;t.accept(e);var n=e.allProductions,r=i.groupBy(n,identifyProductionForDuplicates),a=i.pick(r,function(t){return t.length>1}),c=i.map(i.values(a),function(e){var n=i.first(e),r=createDuplicatesErrorMessage(e,t.name),a=s.getProductionDslName(n),c={message:r,type:o.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:a,occurrence:n.occurrenceInParent},u=getExtraProductionArgument(n);return u&&(c.parameter=u),c});return c}function createDuplicatesErrorMessage(t,e){var n=i.first(t),r=n.occurrenceInParent,o=s.getProductionDslName(n),a=getExtraProductionArgument(n),c="->"+o+"<- with occurrence index: ->"+r+"<-\n                  "+(a?"and argument: "+a:"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: "+e+".\n                  "+(1===r?"note that "+o+" and "+o+"1 both have the same occurrence index 1}":"")+"}\n                  to fix this make sure each usage of "+o+" "+(a?"with the argument: "+a:"")+"\n                  in the rule "+e+" has a different occurrence index (1-5), as that combination acts as a unique\n                  position key in the grammar, which is needed by the parsing engine.";return c=c.replace(/[ \t]+/g," "),c=c.replace(/\s\s+/g,"\n")}function identifyProductionForDuplicates(t){return s.getProductionDslName(t)+"_#_"+t.occurrenceInParent+"_#_"+getExtraProductionArgument(t)}function getExtraProductionArgument(t){return t instanceof a.gast.Terminal?c.tokenName(t.terminalType):t instanceof a.gast.NonTerminal?t.nonTerminalName:""}function validateRuleName(t,e){var n,r=[];return t.match(p)||(n="Invalid Grammar rule name: ->"+t+"<- it must match the pattern: ->"+p.toString()+"<-",r.push({message:n,type:o.ParserDefinitionErrorType.INVALID_RULE_NAME,ruleName:t})),r}function validateRuleDoesNotAlreadyExist(t,e,n){var r,a=[];return i.contains(e,t)&&(r="Duplicate definition, rule: ->"+t+"<- is already defined in the grammar: ->"+n+"<-",a.push({message:r,type:o.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:t})),a}function validateRuleIsOverridden(t,e,n){var r,a=[];return i.contains(e,t)||(r="Invalid rule override, rule: ->"+t+"<- cannot be overridden in the grammar: ->"+n+"<-as it is not defined in any of the super grammars ",a.push({message:r,type:o.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:t})),a}function validateNoLeftRecursion(t,e,n){void 0===n&&(n=[]);var r=[],a=getFirstNoneTerminal(e.definition);if(i.isEmpty(a))return[];var s=t.name,c=i.contains(a,t),u=i.map(n,function(t){return t.name}),l=s+" --> "+u.concat([s]).join(" --> ");if(c){var p="Left Recursion found in grammar.\n"+("rule: <"+s+"> can be invoked from itself (directly or indirectly)\n")+("without consuming any Tokens. The grammar path that causes this is: \n "+l+"\n")+" To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.";r.push({message:p,type:o.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:s})}var f=i.difference(a,n.concat([t])),h=i.map(f,function(e){var r=i.cloneArr(n);return r.push(e),validateNoLeftRecursion(t,e,r)});return r.concat(i.flatten(h))}function getFirstNoneTerminal(t){var e=[];if(i.isEmpty(t))return e;var n=i.first(t);if(n instanceof a.gast.NonTerminal){if(void 0===n.referencedRule)return e;e.push(n.referencedRule)}else if(n instanceof a.gast.Flat||n instanceof a.gast.Option||n instanceof a.gast.RepetitionMandatory||n instanceof a.gast.RepetitionMandatoryWithSeparator||n instanceof a.gast.RepetitionWithSeparator||n instanceof a.gast.Repetition)e=e.concat(getFirstNoneTerminal(n.definition));else if(n instanceof a.gast.Alternation)e=i.flatten(i.map(n.definition,function(t){return getFirstNoneTerminal(t.definition)}));else if(!(n instanceof a.gast.Terminal))throw Error("non exhaustive match");var r=s.isOptionalProd(n),o=t.length>1;if(r&&o){var c=i.drop(t);return e.concat(getFirstNoneTerminal(c))}return e}function validateEmptyOrAlternative(t){var e=new f;t.accept(e);var n=e.alternations,r=i.reduce(n,function(e,n){var r=i.dropRight(n.definition),a=i.map(r,function(e,r){return i.isEmpty(u.first(e))?{message:"Ambiguous empty alternative: <"+(r+1)+">"+(" in <OR"+n.occurrenceInParent+"> inside <"+t.name+"> Rule.\n")+"Only the last alternative may be an empty alternative.",type:o.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:n.occurrenceInParent,alternative:r+1}:null});return e.concat(i.compact(a))},[]);return r}var r=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},i=n(4),o=n(1),a=n(7),s=n(9),c=n(10),u=n(13);e.validateGrammar=validateGrammar,e.identifyProductionForDuplicates=identifyProductionForDuplicates;var l=function(t){function OccurrenceValidationCollector(){t.apply(this,arguments),this.allProductions=[]}return r(OccurrenceValidationCollector,t),OccurrenceValidationCollector.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitOption=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitRepetition=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitAlternation=function(t){this.allProductions.push(t)},OccurrenceValidationCollector.prototype.visitTerminal=function(t){this.allProductions.push(t)},OccurrenceValidationCollector}(a.gast.GAstVisitor);e.OccurrenceValidationCollector=l;var p=/^[a-zA-Z_]\w*$/;e.validateRuleName=validateRuleName,e.validateRuleDoesNotAlreadyExist=validateRuleDoesNotAlreadyExist,e.validateRuleIsOverridden=validateRuleIsOverridden,e.validateNoLeftRecursion=validateNoLeftRecursion,e.getFirstNoneTerminal=getFirstNoneTerminal;var f=function(t){function OrCollector(){t.apply(this,arguments),this.alternations=[]}return r(OrCollector,t),OrCollector.prototype.visitAlternation=function(t){this.alternations.push(t)},OrCollector}(a.gast.GAstVisitor);e.validateEmptyOrAlternative=validateEmptyOrAlternative},function(t,e,n){"use strict";function isSequenceProd(t){return t instanceof i.gast.Flat||t instanceof i.gast.Option||t instanceof i.gast.Repetition||t instanceof i.gast.RepetitionMandatory||t instanceof i.gast.RepetitionMandatoryWithSeparator||t instanceof i.gast.RepetitionWithSeparator||t instanceof i.gast.Terminal||t instanceof i.gast.Rule}function isOptionalProd(t,e){void 0===e&&(e=[]);var n=t instanceof i.gast.Option||t instanceof i.gast.Repetition||t instanceof i.gast.RepetitionWithSeparator;return n?!0:t instanceof i.gast.Alternation?o.some(t.definition,function(t){return isOptionalProd(t,e)}):t instanceof i.gast.NonTerminal&&o.contains(e,t)?!1:t instanceof i.gast.AbstractProduction?(t instanceof i.gast.NonTerminal&&e.push(t),o.every(t.definition,function(t){return isOptionalProd(t,e)})):!1}function isBranchingProd(t){return t instanceof i.gast.Alternation}function getProductionDslName(t){var e=t.constructor,n=a.functionName(e);return s[n]}function cloneProduction(t){var e=new c;return e.visit(t)}var r=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},i=n(7),o=n(4),a=n(3);e.isSequenceProd=isSequenceProd,e.isOptionalProd=isOptionalProd,e.isBranchingProd=isBranchingProd;var s={};s[a.functionName(i.gast.NonTerminal)]="SUBRULE",s[a.functionName(i.gast.Option)]="OPTION",s[a.functionName(i.gast.RepetitionMandatory)]="AT_LEAST_ONE",s[a.functionName(i.gast.RepetitionMandatoryWithSeparator)]="AT_LEAST_ONE_SEP",s[a.functionName(i.gast.RepetitionWithSeparator)]="MANY_SEP",s[a.functionName(i.gast.Repetition)]="MANY",s[a.functionName(i.gast.Alternation)]="OR",s[a.functionName(i.gast.Terminal)]="CONSUME",e.getProductionDslName=getProductionDslName;var c=function(t){function GastCloneVisitor(){t.apply(this,arguments)}return r(GastCloneVisitor,t),GastCloneVisitor.prototype.visitNonTerminal=function(t){return new i.gast.NonTerminal(t.nonTerminalName,void 0,t.occurrenceInParent)},GastCloneVisitor.prototype.visitFlat=function(t){var e=this,n=o.map(t.definition,function(t){return e.visit(t)});return new i.gast.Flat(n)},GastCloneVisitor.prototype.visitOption=function(t){var e=this,n=o.map(t.definition,function(t){return e.visit(t)});return new i.gast.Option(n,t.occurrenceInParent)},GastCloneVisitor.prototype.visitRepetition=function(t){var e=this,n=o.map(t.definition,function(t){return e.visit(t)});return new i.gast.Repetition(n,t.occurrenceInParent)},GastCloneVisitor.prototype.visitRepetitionMandatory=function(t){var e=this,n=o.map(t.definition,function(t){return e.visit(t)});return new i.gast.RepetitionMandatory(n,t.occurrenceInParent)},GastCloneVisitor.prototype.visitRepetitionMandatoryWithSeparator=function(t){var e=this,n=o.map(t.definition,function(t){return e.visit(t)});return new i.gast.RepetitionMandatoryWithSeparator(n,t.separator,t.occurrenceInParent)},GastCloneVisitor.prototype.visitRepetitionWithSeparator=function(t){var e=this,n=o.map(t.definition,function(t){return e.visit(t)});return new i.gast.RepetitionWithSeparator(n,t.separator,t.occurrenceInParent)},GastCloneVisitor.prototype.visitAlternation=function(t){var e=this,n=o.map(t.definition,function(t){return e.visit(t)});return new i.gast.Alternation(n,t.occurrenceInParent)},GastCloneVisitor.prototype.visitTerminal=function(t){return new i.gast.Terminal(t.terminalType,t.occurrenceInParent)},GastCloneVisitor.prototype.visitRule=function(t){var e=this,n=o.map(t.definition,function(t){return e.visit(t)});return new i.gast.Rule(t.name,n,t.orgText)},GastCloneVisitor}(i.gast.GAstVisitor);e.cloneProduction=cloneProduction},function(t,e,n){"use strict";function tokenLabel(t){return hasTokenLabel(t)?t.LABEL:tokenName(t)}function hasTokenLabel(t){return i.isString(t.LABEL)&&""!==t.LABEL}function tokenName(t){return i.isString(t.tokenName)?t.tokenName:o.functionName(t)}function extendToken(t,e,n){void 0===e&&(e=void 0),void 0===n&&(n=s);var r;i.isRegExp(e)||e===a.Lexer.SKIPPED||e===a.Lexer.NA?r=e:i.isFunction(e)&&(n=e,r=void 0);var o=function(){n.apply(this,arguments)};return o=i.assign(o,n),o.tokenName=t,o.prototype=Object.create(n.prototype),o.prototype.constructor=o,i.isUndefined(r)||(o.PATTERN=r),o}var r=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},i=n(4),o=n(3),a=n(11);e.tokenLabel=tokenLabel,e.hasTokenLabel=hasTokenLabel,e.tokenName=tokenName,e.extendToken=extendToken;var s=function(){function Token(t,e,n,r,i,o){void 0===i&&(i=n),void 0===o&&(o=r+t.length-1),this.image=t,this.offset=e,this.startLine=n,this.startColumn=r,this.endLine=i,this.endColumn=o,this.isInsertedInRecovery=!1}return Token.LABEL=void 0,Token}();e.Token=s;var c=function(t){function VirtualToken(){t.call(this,"",-1,-1,-1,-1,-1)}return r(VirtualToken,t),VirtualToken}(s);e.VirtualToken=c;var u=function(t){function EOF(){t.apply(this,arguments)}return r(EOF,t),EOF}(c);e.EOF=u},function(t,e,n){"use strict";var r=n(12),i=n(4);!function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST"}(e.LexerDefinitionErrorType||(e.LexerDefinitionErrorType={}));var o=(e.LexerDefinitionErrorType,function(){function Lexer(t,e){var n=this;void 0===e&&(e=!1),this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.modes=[],this.allPatterns={},this.patternIdxToClass={},this.patternIdxToGroup={},this.patternIdxToLongerAltIdx={},this.patternIdxToCanLineTerminator={},this.patternIdxToPushMode={},this.patternIdxToPopMode={},this.emptyGroups={},i.isArray(t)&&(t={default_mode:t});var o=i.keys(t);if(i.forEach(t,function(t,e){if(n.modes.push(e),n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(r.validatePatterns(t,o)),i.isEmpty(n.lexerDefinitionErrors)){var a=r.analyzeTokenClasses(t);n.allPatterns[e]=a.allPatterns,n.patternIdxToClass[e]=a.patternIdxToClass,n.patternIdxToGroup[e]=a.patternIdxToGroup,n.patternIdxToLongerAltIdx[e]=a.patternIdxToLongerAltIdx,n.patternIdxToCanLineTerminator[e]=a.patternIdxToCanLineTerminator,n.patternIdxToPushMode[e]=a.patternIdxToPushMode,n.patternIdxToPopMode[e]=a.patternIdxToPopMode,n.emptyGroups=i.merge(n.emptyGroups,a.emptyGroups)}}),!i.isEmpty(this.lexerDefinitionErrors)&&!e){var a=i.map(this.lexerDefinitionErrors,function(t){return t.message}),s=a.join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+s)}}return Lexer.prototype.tokenize=function(t,e){var n=this;if(void 0===e&&(e=i.first(this.modes)),!i.isEmpty(this.lexerDefinitionErrors)){var o=i.map(this.lexerDefinitionErrors,function(t){return t.message}),a=o.join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+a)}var s,c,u,l,p,f,h,d,E,T,A,y,O,v,_,R,N,m=t,g=0,S=[],P=[],L=1,k=1,I=i.cloneObj(this.emptyGroups),x=[],C=0,F=[],w=[],b=[],M=[],W=[],U=[],D=[],K=function(t){if(1===D.length){var e="Unable to pop Lexer Mode after encountering Token ->"+t.image+"<- The Mode Stack is empty";P.push({line:t.startLine,column:t.startColumn,length:t.image.length,message:e})}else{D.pop();var r=i.last(D);x=n.allPatterns[r],C=x.length,F=n.patternIdxToLongerAltIdx[r],w=n.patternIdxToGroup[r],b=n.patternIdxToClass[r],M=n.patternIdxToCanLineTerminator[r],W=n.patternIdxToPushMode[r],U=n.patternIdxToPopMode[r]}},G=function(t){D.push(t),x=n.allPatterns[t],C=x.length,F=n.patternIdxToLongerAltIdx[t],w=n.patternIdxToGroup[t],b=n.patternIdxToClass[t],M=n.patternIdxToCanLineTerminator[t],W=n.patternIdxToPushMode[t],U=n.patternIdxToPopMode[t]};for(G(e);t.length>0;){for(s=null,c=0;C>c;c++)if(s=x[c].exec(t),null!==s){p=F[c],p&&(l=x[p].exec(t),l&&l[0].length>s[0].length&&(s=l,c=p));break}if(null!==s){if(f=s[0],h=f.length,d=w[c],void 0!==d&&(E=b[c],T=new E(f,g,L,k),"default"===d?S.push(T):I[d].push(T)),t=t.slice(h),g+=h,k+=h,M[c]){var V=r.countLineTerminators(f);if(0!==V){for(L+=V,_=h-1;_>=0&&(O=f.charCodeAt(_),13!==O&&10!==O);)_--;k=h-_,void 0!==d&&(N=_===h-1,y=N?-1:0,1===V&&N||(T.endLine=L+y,T.endColumn=k-1+-y))}}U[c]&&K(T),W[c]&&G(W[c])}else{for(var H=g,Y=L,B=k,j=!1;!j&&t.length>0;)for(v=t.charCodeAt(0),10===v||13===v&&(1===t.length||t.length>1&&10!==t.charCodeAt(1))?(L++,k=1):k++,t=t.substr(1),g++,u=0;u<x.length&&!(j=x[u].test(t));u++);A=g-H,R="unexpected character: ->"+m.charAt(H)+"<- at offset: "+H+","+(" skipped "+(g-H)+" characters."),P.push({line:Y,column:B,length:A,message:R})}}return{tokens:S,groups:I,errors:P}},Lexer.SKIPPED={description:"This marks a skipped Token pattern, this means each token identified by it willbe consumed and then throw into oblivion, this can be used to for example: skip whitespace."},Lexer.NA=/NOT_APPLICABLE/,Lexer}());e.Lexer=o},function(t,e,n){"use strict";function analyzeTokenClasses(t){var e=o.reject(t,function(t){return t[a]===i.Lexer.NA}),n=o.map(e,function(t){return addStartOfInput(t[a])}),r=o.zipObject(n,e),s=o.map(n,function(t){return r[t.toString()]}),c=o.map(e,function(t){var e=t.GROUP;if(e!==i.Lexer.SKIPPED){if(o.isString(e))return e;if(o.isUndefined(e))return"default";throw Error("non exhaustive match")}}),u=o.map(e,function(t){var n=t.LONGER_ALT;if(n){var r=o.indexOf(e,n);return r}}),l=o.map(e,function(t){return t.PUSH_MODE}),p=o.map(e,function(t){return o.has(t,"POP_MODE")}),f=o.map(n,function(t){return/\\n|\\r|\\s/g.test(t.source)}),h=o.reduce(e,function(t,e){var n=e.GROUP;return o.isString(n)&&(t[n]=[]),t},{});return{allPatterns:n,patternIdxToClass:s,patternIdxToGroup:c,patternIdxToLongerAltIdx:u,patternIdxToCanLineTerminator:f,patternIdxToPushMode:l,patternIdxToPopMode:p,emptyGroups:h}}function validatePatterns(t,e){var n=[],r=findMissingPatterns(t),i=r.valid;n=n.concat(r.errors);var o=findInvalidPatterns(i);return i=o.valid,n=n.concat(o.errors),n=n.concat(findEndOfInputAnchor(i)),n=n.concat(findUnsupportedFlags(i)),n=n.concat(findDuplicatePatterns(i)),n=n.concat(findInvalidGroupType(i)),n=n.concat(findModesThatDoNotExist(i,e))}function findMissingPatterns(t){var e=o.filter(t,function(t){return!o.has(t,a)}),n=o.map(e,function(t){return{message:"Token class: ->"+r.tokenName(t)+"<- missing static 'PATTERN' property",type:i.LexerDefinitionErrorType.MISSING_PATTERN,tokenClasses:[t]}}),s=o.difference(t,e);return{errors:n,valid:s}}function findInvalidPatterns(t){var e=o.filter(t,function(t){var e=t[a];return!o.isRegExp(e)}),n=o.map(e,function(t){return{message:"Token class: ->"+r.tokenName(t)+"<- static 'PATTERN' can only be a RegExp",type:i.LexerDefinitionErrorType.INVALID_PATTERN,tokenClasses:[t]}}),s=o.difference(t,e);return{errors:n,valid:s}}function findEndOfInputAnchor(t){var e=o.filter(t,function(t){var e=t[a];return s.test(e.source)}),n=o.map(e,function(t){return{message:"Token class: ->"+r.tokenName(t)+"<- static 'PATTERN' cannot contain end of input anchor '$'",type:i.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenClasses:[t]}});return n}function findUnsupportedFlags(t){var e=o.filter(t,function(t){var e=t[a];return e instanceof RegExp&&(e.multiline||e.global)}),n=o.map(e,function(t){return{message:"Token class: ->"+r.tokenName(t)+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:i.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenClasses:[t]}});return n}function findDuplicatePatterns(t){var e=[],n=o.map(t,function(n){return o.reduce(t,function(t,r){return n.PATTERN.source!==r.PATTERN.source||o.contains(e,r)||r.PATTERN===i.Lexer.NA?t:(e.push(r),t.push(r),t)},[])});n=o.compact(n);var a=o.filter(n,function(t){return t.length>1}),s=o.map(a,function(t){var e=o.map(t,function(t){return r.tokenName(t)}),n=o.first(t).PATTERN;return{message:"The same RegExp pattern ->"+n+"<-"+("has been used in all the following classes: "+e.join(", ")+" <-"),type:i.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenClasses:t}});return s}function findInvalidGroupType(t){var e=o.filter(t,function(t){if(!o.has(t,"GROUP"))return!1;var e=t.GROUP;return e!==i.Lexer.SKIPPED&&e!==i.Lexer.NA&&!o.isString(e)}),n=o.map(e,function(t){return{message:"Token class: ->"+r.tokenName(t)+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:i.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenClasses:[t]}});return n}function findModesThatDoNotExist(t,e){var n=o.filter(t,function(t){return void 0!==t.PUSH_MODE&&!o.contains(e,t.PUSH_MODE)}),a=o.map(n,function(t){var e="Token class: ->"+r.tokenName(t)+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+t.PUSH_MODE+"<-which does not exist";return{message:e,type:i.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenClasses:[t]}});return a}function addStartOfInput(t){var e=t.ignoreCase?"i":"";return new RegExp("^(?:"+t.source+")",e)}function countLineTerminators(t){for(var e=0,n=0;n<t.length;){var r=t.charCodeAt(n);10===r?e++:13===r&&(n!==t.length-1&&10===t.charCodeAt(n+1)||e++),n++}return e}var r=n(10),i=n(11),o=n(4),a="PATTERN";e.analyzeTokenClasses=analyzeTokenClasses,e.validatePatterns=validatePatterns,e.findMissingPatterns=findMissingPatterns,e.findInvalidPatterns=findInvalidPatterns;var s=/[^\\][\$]/;e.findEndOfInputAnchor=findEndOfInputAnchor,e.findUnsupportedFlags=findUnsupportedFlags,e.findDuplicatePatterns=findDuplicatePatterns,e.findInvalidGroupType=findInvalidGroupType,e.findModesThatDoNotExist=findModesThatDoNotExist,e.addStartOfInput=addStartOfInput,e.countLineTerminators=countLineTerminators},function(t,e,n){"use strict";function first(t){if(t instanceof r.gast.NonTerminal)return first(t.referencedRule);if(t instanceof r.gast.Terminal)return firstForTerminal(t);if(i.isSequenceProd(t))return firstForSequence(t);if(i.isBranchingProd(t))return firstForBranching(t);throw Error("non exhaustive match")}function firstForSequence(t){for(var e,n=[],r=t.definition,a=0,s=r.length>a,c=!0;s&&c;)e=r[a],c=i.isOptionalProd(e),n=n.concat(first(e)),a+=1,s=r.length>a;return o.uniq(n)}function firstForBranching(t){var e=o.map(t.definition,function(t){return first(t)});return o.uniq(o.flatten(e))}function firstForTerminal(t){return[t.terminalType]}var r=n(7),i=n(9),o=n(4);e.first=first,e.firstForSequence=firstForSequence,e.firstForBranching=firstForBranching,e.firstForTerminal=firstForTerminal},function(t,e,n){"use strict";function computeAllProdsFollows(t){var e=new o.HashTable;return c.forEach(t,function(t){var n=new p(t).startWalking();e.putAll(n)}),e}function buildBetweenProdsFollowPrefix(t,e){return t.name+e+u.IN}function buildInProdFollowPrefix(t){var e=l.tokenName(t.terminalType);return e+t.occurrenceInParent+u.IN}var r=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},i=n(15),o=n(3),a=n(7),s=n(13),c=n(4),u=n(16),l=n(10),p=function(t){function ResyncFollowsWalker(e){t.call(this),this.topProd=e,this.follows=new o.HashTable}return r(ResyncFollowsWalker,t),ResyncFollowsWalker.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},ResyncFollowsWalker.prototype.walkTerminal=function(t,e,n){},ResyncFollowsWalker.prototype.walkProdRef=function(t,e,n){var r=buildBetweenProdsFollowPrefix(t.referencedRule,t.occurrenceInParent)+this.topProd.name,i=e.concat(n),o=new a.gast.Flat(i),c=s.first(o);this.follows.put(r,c)},ResyncFollowsWalker}(i.RestWalker);e.ResyncFollowsWalker=p,e.computeAllProdsFollows=computeAllProdsFollows,e.buildBetweenProdsFollowPrefix=buildBetweenProdsFollowPrefix,e.buildInProdFollowPrefix=buildInProdFollowPrefix},function(t,e,n){"use strict";function restForRepetitionWithSeparator(t,e,n){var i=[new r.gast.Option([new r.gast.Terminal(t.separator)].concat(t.definition))],o=i.concat(e,n);return o}var r=n(7),i=n(4),o=function(){function RestWalker(){}return RestWalker.prototype.walk=function(t,e){var n=this;void 0===e&&(e=[]),i.forEach(t.definition,function(o,a){var s=i.drop(t.definition,a+1);if(o instanceof r.gast.NonTerminal)n.walkProdRef(o,s,e);else if(o instanceof r.gast.Terminal)n.walkTerminal(o,s,e);else if(o instanceof r.gast.Flat)n.walkFlat(o,s,e);else if(o instanceof r.gast.Option)n.walkOption(o,s,e);else if(o instanceof r.gast.RepetitionMandatory)n.walkAtLeastOne(o,s,e);else if(o instanceof r.gast.RepetitionMandatoryWithSeparator)n.walkAtLeastOneSep(o,s,e);else if(o instanceof r.gast.RepetitionWithSeparator)n.walkManySep(o,s,e);else if(o instanceof r.gast.Repetition)n.walkMany(o,s,e);else{if(!(o instanceof r.gast.Alternation))throw Error("non exhaustive match");n.walkOr(o,s,e)}})},RestWalker.prototype.walkTerminal=function(t,e,n){},RestWalker.prototype.walkProdRef=function(t,e,n){},RestWalker.prototype.walkFlat=function(t,e,n){var r=e.concat(n);this.walk(t,r)},RestWalker.prototype.walkOption=function(t,e,n){var r=e.concat(n);this.walk(t,r)},RestWalker.prototype.walkAtLeastOne=function(t,e,n){var i=[new r.gast.Option(t.definition)].concat(e,n);this.walk(t,i)},RestWalker.prototype.walkAtLeastOneSep=function(t,e,n){var r=restForRepetitionWithSeparator(t,e,n);this.walk(t,r)},RestWalker.prototype.walkMany=function(t,e,n){var i=[new r.gast.Option(t.definition)].concat(e,n);this.walk(t,i)},RestWalker.prototype.walkManySep=function(t,e,n){var r=restForRepetitionWithSeparator(t,e,n);this.walk(t,r)},RestWalker.prototype.walkOr=function(t,e,n){var o=this,a=e.concat(n);i.forEach(t.definition,function(t){var e=new r.gast.Flat([t]);o.walk(e,a)})},RestWalker}();e.RestWalker=o},function(t,e){"use strict";e.IN="_~IN~_"},function(t,e,n){"use strict";function buildLookaheadForTopLevel(t){var e=new r.gast.Flat(t.definition),n=i.first(e);return getSimpleLookahead(n)}function buildLookaheadForOption(t,e){return buildLookAheadForGrammarProd(o.NextInsideOptionWalker,t,e)}function buildLookaheadForMany(t,e){return buildLookAheadForGrammarProd(o.NextInsideManyWalker,t,e)}function buildLookaheadForManySep(t,e){return buildLookAheadForGrammarProd(o.NextInsideManySepWalker,t,e)}function buildLookaheadForAtLeastOne(t,e){return buildLookAheadForGrammarProd(o.NextInsideAtLeastOneWalker,t,e)}function buildLookaheadForAtLeastOneSep(t,e){return buildLookAheadForGrammarProd(o.NextInsideAtLeastOneSepWalker,t,e)}function buildLookaheadForOr(t,e,n){void 0===n&&(n=!1);var r=new o.NextInsideOrWalker(e,t).startWalking();n||checkForOrAmbiguities(r,t,e);var i=a.isEmpty(a.last(r));if(i){var s=r.length-1;return function(){for(var t=this.NEXT_TOKEN(),e=0;s>e;e++)for(var n=r[e],i=0;i<n.length;i++)if(t instanceof n[i])return e;return s}}return function(){for(var t=this.NEXT_TOKEN(),e=0;e<r.length;e++)for(var n=r[e],i=0;i<n.length;i++)if(t instanceof n[i])return e;return-1}}function checkForOrAmbiguities(t,e,n){var r=checkAlternativesAmbiguities(t);if(!a.isEmpty(r)){var i=a.map(r,function(t){return"Ambiguous alternatives: <"+t.alts.join(" ,")+"> in <OR"+e+"> inside <"+n.name+"> "+("Rule, <"+s.tokenName(t.token)+"> may appears as the first Terminal in all these alternatives.\n");
});throw new Error(i.join("\n ---------------- \n")+"To Resolve this, either: \n1. refactor your grammar to be LL(1)\n2. provide explicit lookahead functions in the form {WHEN:laFunc, THEN_DO:...}\n3. Add ignore arg to this OR Production:\nOR([], 'msg', recognizer.IGNORE_AMBIGUITIES)\nIn that case the parser will always pick the first alternative that matches and ignore all the others")}}function checkAlternativesAmbiguities(t){var e=a.flatten(t),n=a.uniq(e),r=a.map(n,function(e){var n=a.pick(t,function(t){return a.find(t,function(t){return t===e})}),r=a.map(a.keys(n),function(t){return parseInt(t,10)+1});return{token:e,alts:r}}),i=a.filter(r,function(t){return t.alts.length>1});return i}function buildLookAheadForGrammarProd(t,e,n){var r={ruleStack:[n.name],occurrenceStack:[1],occurrence:e},i=new t(n,r),o=i.startWalking();return getSimpleLookahead(o)}function getSimpleLookahead(t){return function(){for(var e=this.NEXT_TOKEN(),n=0;n<t.length;n++)if(e instanceof t[n])return!0;return!1}}var r=n(7),i=n(13),o=n(18),a=n(4),s=n(10);e.buildLookaheadForTopLevel=buildLookaheadForTopLevel,e.buildLookaheadForOption=buildLookaheadForOption,e.buildLookaheadForMany=buildLookaheadForMany,e.buildLookaheadForManySep=buildLookaheadForManySep,e.buildLookaheadForAtLeastOne=buildLookaheadForAtLeastOne,e.buildLookaheadForAtLeastOneSep=buildLookaheadForAtLeastOneSep,e.buildLookaheadForOr=buildLookaheadForOr,e.checkForOrAmbiguities=checkForOrAmbiguities,e.checkAlternativesAmbiguities=checkAlternativesAmbiguities},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function __(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)},i=n(15),o=n(7),a=n(4),s=n(10),c=n(13),u=function(t){function AbstractNextPossibleTokensWalker(e,n){t.call(this),this.topProd=e,this.path=n,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}return r(AbstractNextPossibleTokensWalker,t),AbstractNextPossibleTokensWalker.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=a.cloneArr(this.path.ruleStack).reverse(),this.occurrenceStack=a.cloneArr(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},AbstractNextPossibleTokensWalker.prototype.walk=function(e,n){void 0===n&&(n=[]),this.found||t.prototype.walk.call(this,e,n)},AbstractNextPossibleTokensWalker.prototype.walkProdRef=function(t,e,n){if(t.referencedRule.name===this.nextProductionName&&t.occurrenceInParent===this.nextProductionOccurrence){var r=e.concat(n);this.updateExpectedNext(),this.walk(t.referencedRule,r)}},AbstractNextPossibleTokensWalker.prototype.updateExpectedNext=function(){a.isEmpty(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},AbstractNextPossibleTokensWalker}(i.RestWalker);e.AbstractNextPossibleTokensWalker=u;var l=function(t){function NextAfterTokenWalker(e,n){t.call(this,e,n),this.path=n,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=s.tokenName(this.path.lastTok),this.nextTerminalOccurrence=this.path.lastTokOccurrence}return r(NextAfterTokenWalker,t),NextAfterTokenWalker.prototype.walkTerminal=function(t,e,n){if(this.isAtEndOfPath&&s.tokenName(t.terminalType)===this.nextTerminalName&&t.occurrenceInParent===this.nextTerminalOccurrence&&!this.found){var r=e.concat(n),i=new o.gast.Flat(r);this.possibleTokTypes=c.first(i),this.found=!0}},NextAfterTokenWalker}(u);e.NextAfterTokenWalker=l;var p=function(t){function NextInsideOptionWalker(e,n){t.call(this,e,n),this.path=n,this.nextOptionOccurrence=0,this.nextOptionOccurrence=this.path.occurrence}return r(NextInsideOptionWalker,t),NextInsideOptionWalker.prototype.walkOption=function(e,n,r){if(this.isAtEndOfPath&&e.occurrenceInParent===this.nextOptionOccurrence&&!this.found){var i=new o.gast.Flat(e.definition);this.possibleTokTypes=c.first(i),this.found=!0}else t.prototype.walkOption.call(this,e,n,r)},NextInsideOptionWalker}(u);e.NextInsideOptionWalker=p;var f=function(t){function NextInsideManyWalker(e,n){t.call(this,e,n),this.path=n,this.nextOccurrence=0,this.nextOccurrence=this.path.occurrence}return r(NextInsideManyWalker,t),NextInsideManyWalker.prototype.walkMany=function(e,n,r){if(this.isAtEndOfPath&&e.occurrenceInParent===this.nextOccurrence&&!this.found){var i=new o.gast.Flat(e.definition);this.possibleTokTypes=c.first(i),this.found=!0}else t.prototype.walkMany.call(this,e,n,r)},NextInsideManyWalker}(u);e.NextInsideManyWalker=f;var h=function(t){function NextInsideManySepWalker(e,n){t.call(this,e,n),this.path=n,this.nextOccurrence=0,this.nextOccurrence=this.path.occurrence}return r(NextInsideManySepWalker,t),NextInsideManySepWalker.prototype.walkManySep=function(e,n,r){if(this.isAtEndOfPath&&e.occurrenceInParent===this.nextOccurrence&&!this.found){var i=new o.gast.Flat(e.definition);this.possibleTokTypes=c.first(i),this.found=!0}else t.prototype.walkManySep.call(this,e,n,r)},NextInsideManySepWalker}(u);e.NextInsideManySepWalker=h;var d=function(t){function NextInsideAtLeastOneWalker(e,n){t.call(this,e,n),this.path=n,this.nextOccurrence=0,this.nextOccurrence=this.path.occurrence}return r(NextInsideAtLeastOneWalker,t),NextInsideAtLeastOneWalker.prototype.walkAtLeastOne=function(e,n,r){if(this.isAtEndOfPath&&e.occurrenceInParent===this.nextOccurrence&&!this.found){var i=new o.gast.Flat(e.definition);this.possibleTokTypes=c.first(i),this.found=!0}else t.prototype.walkAtLeastOne.call(this,e,n,r)},NextInsideAtLeastOneWalker}(u);e.NextInsideAtLeastOneWalker=d;var E=function(t){function NextInsideAtLeastOneSepWalker(e,n){t.call(this,e,n),this.path=n,this.nextOccurrence=0,this.nextOccurrence=this.path.occurrence}return r(NextInsideAtLeastOneSepWalker,t),NextInsideAtLeastOneSepWalker.prototype.walkAtLeastOneSep=function(e,n,r){if(this.isAtEndOfPath&&e.occurrenceInParent===this.nextOccurrence&&!this.found){var i=new o.gast.Flat(e.definition);this.possibleTokTypes=c.first(i),this.found=!0}else t.prototype.walkAtLeastOneSep.call(this,e,n,r)},NextInsideAtLeastOneSepWalker}(u);e.NextInsideAtLeastOneSepWalker=E;var T=function(t){function NextInsideOrWalker(e,n){t.call(this),this.topRule=e,this.occurrence=n,this.result=[]}return r(NextInsideOrWalker,t),NextInsideOrWalker.prototype.startWalking=function(){return this.walk(this.topRule),this.result},NextInsideOrWalker.prototype.walkOr=function(e,n,r){e.occurrenceInParent===this.occurrence?this.result=a.map(e.definition,function(t){var e=new o.gast.Flat([t]);return c.first(e)}):t.prototype.walkOr.call(this,e,n,r)},NextInsideOrWalker}(i.RestWalker);e.NextInsideOrWalker=T;var A=function(t){function AbstractNextTerminalAfterProductionWalker(e,n){t.call(this),this.topRule=e,this.occurrence=n,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}return r(AbstractNextTerminalAfterProductionWalker,t),AbstractNextTerminalAfterProductionWalker.prototype.startWalking=function(){return this.walk(this.topRule),this.result},AbstractNextTerminalAfterProductionWalker}(i.RestWalker);e.AbstractNextTerminalAfterProductionWalker=A;var y=function(t){function NextTerminalAfterManyWalker(){t.apply(this,arguments)}return r(NextTerminalAfterManyWalker,t),NextTerminalAfterManyWalker.prototype.walkMany=function(e,n,r){if(e.occurrenceInParent===this.occurrence){var i=a.first(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof o.gast.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.occurrenceInParent)}else t.prototype.walkMany.call(this,e,n,r)},NextTerminalAfterManyWalker}(A);e.NextTerminalAfterManyWalker=y;var O=function(t){function NextTerminalAfterManySepWalker(){t.apply(this,arguments)}return r(NextTerminalAfterManySepWalker,t),NextTerminalAfterManySepWalker.prototype.walkManySep=function(e,n,r){if(e.occurrenceInParent===this.occurrence){var i=a.first(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof o.gast.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.occurrenceInParent)}else t.prototype.walkManySep.call(this,e,n,r)},NextTerminalAfterManySepWalker}(A);e.NextTerminalAfterManySepWalker=O;var v=function(t){function NextTerminalAfterAtLeastOneWalker(){t.apply(this,arguments)}return r(NextTerminalAfterAtLeastOneWalker,t),NextTerminalAfterAtLeastOneWalker.prototype.walkAtLeastOne=function(e,n,r){if(e.occurrenceInParent===this.occurrence){var i=a.first(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof o.gast.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.occurrenceInParent)}else t.prototype.walkAtLeastOne.call(this,e,n,r)},NextTerminalAfterAtLeastOneWalker}(A);e.NextTerminalAfterAtLeastOneWalker=v;var _=function(t){function NextTerminalAfterAtLeastOneSepWalker(){t.apply(this,arguments)}return r(NextTerminalAfterAtLeastOneSepWalker,t),NextTerminalAfterAtLeastOneSepWalker.prototype.walkAtLeastOneSep=function(e,n,r){if(e.occurrenceInParent===this.occurrence){var i=a.first(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof o.gast.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.occurrenceInParent)}else t.prototype.walkAtLeastOneSep.call(this,e,n,r)},NextTerminalAfterAtLeastOneSepWalker}(A);e.NextTerminalAfterAtLeastOneSepWalker=_},function(t,e,n){"use strict";function buildTopProduction(t,n,i){e.terminalNameToConstructor=i;var o=" "+t,a=removeComments(" "+o),s=removeStringLiterals(a),c=createRanges(s),u=new r.Range(0,t.length+2);return buildTopLevel(n,u,c,t)}function buildTopLevel(t,e,n,r){var o=new i.gast.Rule(t,[],r);return buildAbstractProd(o,e,n)}function buildProdGast(t,e){switch(t.type){case a.AT_LEAST_ONE:return buildAtLeastOneProd(t,e);case a.AT_LEAST_ONE_SEP:return buildAtLeastOneSepProd(t,e);case a.MANY_SEP:return buildManySepProd(t,e);case a.MANY:return buildManyProd(t,e);case a.OPTION:return buildOptionProd(t,e);case a.OR:return buildOrProd(t,e);case a.FLAT:return buildAbstractProd(new i.gast.Flat([]),t.range,e);case a.REF:return buildRefProd(t);case a.TERMINAL:return buildTerminalProd(t);default:throw Error("non exhaustive match")}}function buildRefProd(t){var e=u.exec(t.text),n=void 0===e[1],r=n?1:parseInt(e[1],10),o=e[2],a=new i.gast.NonTerminal(o,void 0,r);return a.implicitOccurrenceIndex=n,a}function buildTerminalProd(t){var n=s.exec(t.text),r=void 0===n[1],o=r?1:parseInt(n[1],10),a=n[2],c=e.terminalNameToConstructor[a];if(!c)throw Error("Terminal Token name: "+a+" not found");var u=new i.gast.Terminal(c,o);return u.implicitOccurrenceIndex=r,u}function buildProdWithOccurrence(t,e,n,r){var i=t.exec(n.text),o=void 0===i[1];return e.occurrenceInParent=o?1:parseInt(i[1],10),e.implicitOccurrenceIndex=o,buildAbstractProd(e,n.range,r)}function buildAtLeastOneProd(t,e){return buildProdWithOccurrence(O,new i.gast.RepetitionMandatory([]),t,e)}function buildAtLeastOneSepProd(t,e){return buildRepetitionWithSep(t,e,i.gast.RepetitionMandatoryWithSeparator,A)}function buildManyProd(t,e){return buildProdWithOccurrence(h,new i.gast.Repetition([]),t,e)}function buildManySepProd(t,e){return buildRepetitionWithSep(t,e,i.gast.RepetitionWithSeparator,E)}function buildRepetitionWithSep(t,n,r,i){var o=i.exec(t.text),a=void 0===o[1],s=a?1:parseInt(o[1],10),c=o[2],u=e.terminalNameToConstructor[c];if(!u)throw Error("Separator Terminal Token name: "+c+" not found");var l=new r([],u,s);return l.implicitOccurrenceIndex=a,buildAbstractProd(l,t.range,n)}function buildOptionProd(t,e){return buildProdWithOccurrence(p,new i.gast.Option([]),t,e)}function buildOrProd(t,e){return buildProdWithOccurrence(_,new i.gast.Alternation([]),t,e)}function buildAbstractProd(t,e,n){var r=getDirectlyContainedRanges(e,n),i=o.sortBy(r,function(t){return t.range.start}),a=[];return o.forEach(i,function(t){a.push(buildProdGast(t,n))}),t.definition=a,t}function getDirectlyContainedRanges(t,e){return o.filter(e,function(n){var r=t.strictlyContainsRange(n.range),i=o.every(e,function(e){var r=e.range.strictlyContainsRange(n.range),i=e.range.isStrictlyContainedInRange(t);return!(r&&i)});return r&&i})}function removeComments(t){var e=t.replace(m,""),n=e.replace(g,"");return n}function removeStringLiterals(t){var e=t.replace(S,""),n=e.replace(P,"");return n}function createRanges(t){var e=createTerminalRanges(t),n=createRefsRanges(t),r=createAtLeastOneRanges(t),i=createAtLeastOneSepRanges(t),o=createManyRanges(t),a=createManySepRanges(t),s=createOptionRanges(t),c=createOrRanges(t);return[].concat(e,n,r,i,o,a,s,c)}function createTerminalRanges(t){return createRefOrTerminalProdRangeInternal(t,a.TERMINAL,c)}function createRefsRanges(t){return createRefOrTerminalProdRangeInternal(t,a.REF,l)}function createAtLeastOneRanges(t){return createOperatorProdRangeParenthesis(t,a.AT_LEAST_ONE,v)}function createAtLeastOneSepRanges(t){return createOperatorProdRangeParenthesis(t,a.AT_LEAST_ONE_SEP,y)}function createManyRanges(t){return createOperatorProdRangeParenthesis(t,a.MANY,d)}function createManySepRanges(t){return createOperatorProdRangeParenthesis(t,a.MANY_SEP,T)}function createOptionRanges(t){return createOperatorProdRangeParenthesis(t,a.OPTION,f)}function createOrRanges(t){var e=createOperatorProdRangeParenthesis(t,a.OR,R),n=createOrPartRanges(e);return e.concat(n)}function createOrPartRanges(t){var e=[];o.forEach(t,function(t){var n=createOperatorProdRangeInternal(t.text,a.FLAT,N,L),r=t.range.start;o.forEach(n,function(t){t.range.start+=r,t.range.end+=r}),e=e.concat(n)});var n=o.uniq(e,function(t){return t.type+"~"+t.range.start+"~"+t.range.end+"~"+t.text});return n}function createRefOrTerminalProdRangeInternal(t,e,n){for(var i,o=[];i=n.exec(t);){var a=i.index,s=n.lastIndex,c=new r.Range(a,s),u=i[0];o.push({range:c,text:u,type:e})}return o}function createOperatorProdRangeParenthesis(t,e,n){return createOperatorProdRangeInternal(t,e,n,k)}function createOperatorProdRangeInternal(t,e,n,i){for(var o,a=[];o=n.exec(t);){var s=o.index,c=i(s+o[0].length,t),u=new r.Range(s,c),l=t.substr(s,c-s+1);a.push({range:u,text:l,type:e})}return a}function findClosingOffset(t,e,n,r){for(var i=[1],a=-1;!o.isEmpty(i)&&a+n<r.length;){a++;var s=r.charAt(n+a);s===t?i.push(1):s===e&&i.pop()}if(o.isEmpty(i))return a+n;throw new Error("INVALID INPUT TEXT, UNTERMINATED PARENTHESIS")}var r=n(20),i=n(7),o=n(4);!function(t){t[t.OPTION=0]="OPTION",t[t.OR=1]="OR",t[t.MANY=2]="MANY",t[t.MANY_SEP=3]="MANY_SEP",t[t.AT_LEAST_ONE=4]="AT_LEAST_ONE",t[t.AT_LEAST_ONE_SEP=5]="AT_LEAST_ONE_SEP",t[t.REF=6]="REF",t[t.TERMINAL=7]="TERMINAL",t[t.FLAT=8]="FLAT"}(e.ProdType||(e.ProdType={}));var a=e.ProdType,s=/\.\s*CONSUME(\d)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,c=new RegExp(s.source,"g"),u=/\.\s*SUBRULE(\d)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,l=new RegExp(u.source,"g"),p=/\.\s*OPTION(\d)?\s*\(/,f=new RegExp(p.source,"g"),h=/\.\s*MANY(\d)?\s*\(/,d=new RegExp(h.source,"g"),E=/\.\s*MANY_SEP(\d)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,T=new RegExp(E.source,"g"),A=/\.\s*AT_LEAST_ONE_SEP(\d)?\s*\(\s*(?:[a-zA-Z_$]\w*\s*\.\s*)*([a-zA-Z_$]\w*)/,y=new RegExp(A.source,"g"),O=/\.\s*AT_LEAST_ONE(\d)?\s*\(/,v=new RegExp(O.source,"g"),_=/\.\s*OR(\d)?\s*\(/,R=new RegExp(_.source,"g"),N=/{\s*(WHEN|ALT)\s*:/g;e.terminalNameToConstructor={},e.buildTopProduction=buildTopProduction,e.buildProdGast=buildProdGast,e.getDirectlyContainedRanges=getDirectlyContainedRanges;var m=/\/\/.*/g,g=/\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\//g,S=/"([^\\"]+|\\([bfnrtv"\\/]|u[0-9a-fA-F]{4}))*"/g,P=/'([^\\']+|\\([bfnrtv'\\/]|u[0-9a-fA-F]{4}))*'/g;e.removeComments=removeComments,e.removeStringLiterals=removeStringLiterals,e.createRanges=createRanges,e.createTerminalRanges=createTerminalRanges,e.createRefsRanges=createRefsRanges,e.createAtLeastOneRanges=createAtLeastOneRanges,e.createAtLeastOneSepRanges=createAtLeastOneSepRanges,e.createManyRanges=createManyRanges,e.createManySepRanges=createManySepRanges,e.createOptionRanges=createOptionRanges,e.createOrRanges=createOrRanges;var L=o.partial(findClosingOffset,"{","}"),k=o.partial(findClosingOffset,"(",")");e.createOrPartRanges=createOrPartRanges,e.findClosingOffset=findClosingOffset},function(t,e){"use strict";function isValidRange(t,e){return!(0>t||t>e)}var n=function(){function Range(t,e){if(this.start=t,this.end=e,!isValidRange(t,e))throw new Error("INVALID RANGE")}return Range.prototype.contains=function(t){return this.start<=t&&this.end>=t},Range.prototype.containsRange=function(t){return this.start<=t.start&&this.end>=t.end},Range.prototype.isContainedInRange=function(t){return t.containsRange(this)},Range.prototype.strictlyContainsRange=function(t){return this.start<t.start&&this.end>t.end},Range.prototype.isStrictlyContainedInRange=function(t){return t.strictlyContainsRange(this)},Range}();e.Range=n,e.isValidRange=isValidRange},function(t,e,n){"use strict";function clearCache(){r.clearCache()}var r=n(2);e.clearCache=clearCache}])});